<html>
<head>
	<title>Coronavirus (COVID-19) Resource Exhaustion Simulator</title>

	<META name="description" content="A pandemic simulator exemplifying hospital resource exhaustion.">
	<META name="keywords" content="Coronavirus, COVID-19, Face Masks, Regional Resources, CDC Resources, Trackers">
	<META name="copyright" content="(c) 2020 Jason Baker">
	<META name="Author" content="Jason Baker">

	<link rel="stylesheet" href="inc/bootstrap-4.4.1/bootstrap.min.css">
	<link rel="stylesheet" href="inc/bootswatch-flatly/bootstrap.min.css">
	<!-- from: https://github.com/evilstreak/markdown-js" -->
	<script src="inc/markdown-js-0.5.0/markdown.js"></script>
	<!-- <script src="inc/bootstrap-4.4.1/bootstrap.min.js"></script> -->
	<!-- <link rel="stylesheet" href="inc/fontawesome-free-5.12.1/css/all.min.css"> -->
	<script src="lib.js"></script>
	<script src="classes.js"></script>
	<script src="simulator.js"></script>
	
	<style>
		* { font-size:3vmin; }
		@media screen and (min-width: 1000px) {
			* { font-size:18px; }
		}
		.jumbotron { min-height:100%; max-width:1200px; margin-left:auto; margin-right:auto; }
		H5 { font-weight:700; }
		P { margin-left:0.5rem; margin-right:0.5rem; text-align:justify; }
		A { color:#3498DB!important; }
		IMG { max-width:100%; }
		.section { margin-bottom:1rem; border-top:1px solid rgba(0,0,0,0.15); padding-top:1rem; }
	</style>

	<script>		

		function runSimulation() {
			debugMode = true;

			var coronaSimSettings = new CoronaSimSettings();
			coronaSimSettings.initialCaseCountInt = getSliderValue("initialCasesSlider");
			coronaSimSettings.initialDate = new Date();
			coronaSimSettings.percentNewCasesPerDayInt = getSliderValue("newCasesPerDaySlider"); 
			coronaSimSettings.percentCasesResultingInHospitalizationInt = getSliderValue("casesResultingInHospitalizationSlider");
			coronaSimSettings.percentCasesResultingInDeathInt = getSliderValue("casesResultingInDeathSlider");
			coronaSimSettings.percentCasesResultingInSurvivalInt = 100 - coronaSimSettings.percentCasesResultingInDeathInt;
			coronaSimSettings.numberOfHospitalBedsInt = getSliderValue("hospitalBedsAvailableSlider"); // 1 million			
			coronaSimSettings.numberOfDaysHospitalizedInt = getSliderValue("numberOfDaysHospitalized");


			var numberOfDaysToSimulate = getSliderValue("daysToSimulate");			
			/* Note: this is where all of the magic happens, this method makes a simulator, steps through the sim, and returns html output */
			var tableHTML = generateSimulationTable(numberOfDaysToSimulate, coronaSimSettings);
			document.getElementById("simulationOutput").innerHTML = tableHTML;
		}

		document.addEventListener('DOMContentLoaded', function() {			
			//setup slider's onchange/oninput/initial label value
			for (var slider of document.getElementsByClassName("form-control-range")) {
				slider.onchange = function() { updateSliderLabel(this); }
				slider.oninput = slider.onchange;
				updateSliderLabel(slider);
			}
		}, false);

	</script>
</head>
<body>

	<div class="jumbotron">
		<h1>Coronavirus Simulator</h1>

		<div class='section'>
			<h3>What?</h3>

			<p>This is a dynamic simulator built to help citizens understand hospital resource exhaustion.</p>
		</div>

		<div class="form-row">
			<div class="form-group col-md-6">
				<label class="form-label">Initial Cases</label>
				<input class="form-control-range" id="initialCasesSlider" type="range" min="10" max="100000" value="25000" />
			</div>
			<div class="form-group col-md-6">
				<label class="form-label">Days To Simulate</label>
				<input class="form-control-range" id="daysToSimulate" type="range" min="30" max="1000" value="30" />
			</div>
		</div>
		<div class="form-row">
			<div class="form-group col-md-6">
				<label class="form-label">New Cases Per Day</label>
				<input class="form-control-range" id="newCasesPerDaySlider" type="range" min="1" max="100" value="25" format="percentage" />
			</div>
			<div class="form-group col-md-6">
				<label class="form-label">Cases Resulting In Death</label>
				<input class="form-control-range" id="casesResultingInDeathSlider" type="range" min="1" max="100" value="4" format="percentage" />
			</div>
			
		</div>
		<div class="form-row">
			<div class="form-group col-md-6">
				<label class="form-label">Cases Resulting In Hospitalization</label>
				<input class="form-control-range" id="casesResultingInHospitalizationSlider" type="range" min="1" max="100" value="10" format="percentage" />
			</div>
			<div class="form-group col-md-6">
				<label class="form-label">Number Of Days In Hospital Per Hospitalization</label>
				<input class="form-control-range" id="numberOfDaysHospitalized" type="range" min="1" max="30" value="3" />
			</div>
		</div>
		<div class="form-row">
			<div class="form-group col-md-6">
				<label class="form-label">Hospital Beds Available</label>
				<input class="form-control-range" id="hospitalBedsAvailableSlider" type="range" min="1000" max="5000000" value="100000" />
			</div>
		</div>
		<div class="form-row">
			<button class="btn btn-primary" onClick="runSimulation()">Run Simulation</button>
		</div>

		<hr />
		<div id='simulationOutput' />
	</div>

</body>
</html>